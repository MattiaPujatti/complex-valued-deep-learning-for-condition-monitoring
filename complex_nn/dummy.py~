import haiku as hk

class CmplxBatchNorm(hk.Module):

    def __init__(self,
                 create_scale: bool,
                 create_offset: bool,
                 decay_rate: float,
                 eps: float = 1e-5,
                 scale_init: Optional[hk.initializers.Initializer] = None,
                 offset_init: Optional[hk.initializers.Initializer] = None,
                 axis: Optional[Sequence[int]] = None,
                 data_format: str = "channels_last",
                 name: Optional[str] = None,
    ):

        super().__init__(name=name)
        if not create_scale and scale_init is not None:
            raise ValueError("Cannot set `scale_init` if `create_scale=False`")
        if not create_offset and offset_init is not None:
            raise ValueError("Cannot set `offset_init` if `create_offset=False`")
                 
